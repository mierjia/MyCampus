{"remainingRequest":"D:\\Desktop\\InterConnect\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\InterConnect\\web\\src\\components\\comment.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\Desktop\\InterConnect\\web\\src\\components\\comment.vue","mtime":1641975356000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5oZWxwIHsKICBtaW4taGVpZ2h0OiAyMDBweDsKfQouY29tbWVudCB7CiAgbWFyZ2luLXRvcDogMTBweDsKICBtYXJnaW4tbGVmdDogMjBweDsKfQouY29tbWVudC1mb290ZXIgewogIGhlaWdodDogMzBweDsKICBsaW5lLWhlaWdodDogMzBweDsKfQouY29tbWVudC1mb290ZXIgcCB7CiAgZmxvYXQ6IGxlZnQ7CiAgbWFyZ2luLWxlZnQ6IDIwJTsKICBmb250LXNpemU6IDE1cHg7Cn0KLmNvbW1lbnR0b3AgewogIG1hcmdpbi10b3A6IDIwcHg7CiAgZm9udC1zaXplOiAyMHB4OwogIHdpZHRoOiAxMDAlOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBwYWRkaW5nOiAxMHB4OwogIGJhY2tncm91bmQtY29sb3I6IHJnYigyNTAsIDI0NCwgMjQ0KTsKfQoKLnRvdXNlciB7CiAgY29sb3I6IGJsdWU7Cn0K"},{"version":3,"sources":["comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAibA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"comment.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"comment\">\n    <section id=\"comments\">\n      <h3 id=\"comments-title\">({{ commentnum }}) 留言</h3>\n\n      <article id=\"comment-4\" v-if=\"userinfo\">\n        <img\n          :src=\"avatar\"\n          class=\"avatar touxiang avatar-60 photo\"\n          style=\" width: 50px;height: 50px\"\n        />\n        <h4 class=\"author\" style=\" display: inline;\">{{ nickname }}</h4>\n      </article>\n      <div v-if=\"editorid !== -1\" @click=\"usercomment\" class=\"commenttop\">\n        添加评论\n      </div>\n      <vue-editor\n        v-if=\"editorid === -1\"\n        style=\"margin-top:40px\"\n        useCustomImageHandler\n        @image-added=\"handleImageAdded\"\n        v-model=\"comment_content\"\n      ></vue-editor>\n      <div class=\"comment\">\n        <el-button type=\"info\" v-if=\"editorid === -1\" @click=\"setcomment\"\n          >评论</el-button\n        >\n      </div>\n      <ol class=\"commentlist\">\n        <li\n          v-for=\"(item, id) in commentlist\"\n          :key=\"id\"\n          class=\"comment even thread-even depth-1\"\n          id=\"li-comment-2\"\n        >\n          <article id=\"comment-2\">\n            <el-popover placement=\"top\" width=\"400\" trigger=\"hover\">\n              <span>\n                <li\n                  class=\"comment even thread-odd thread-alt depth-1\"\n                  id=\"li-comment-4\"\n                >\n                  <article id=\"comment-4\">\n                    <img\n                      :src=\"item.avatar\"\n                      class=\"avatar touxiang avatar-60 photo\"\n                      height=\"60\"\n                      width=\"60\"\n                    />\n\n                    <div class=\"comment-meta\">\n                      <h5 class=\"author\">{{ item.nickname }}</h5>\n\n                      <p class=\"date\" v-if=\"item.realstate == 3\">认证用户</p>\n                      <p class=\"date\" v-else>未认证用户</p>\n                    </div>\n                  </article>\n                </li>\n                <div class=\"xinxi\">\n                  <p style=\"  color: #000;\">账号：</p>\n                  <p>{{ item.username }}</p>\n                </div>\n                <div class=\"xinxi\">\n                  <p style=\"  color: #000;\">邮箱：</p>\n                  <p>{{ item.mail }}</p>\n                </div>\n                <div class=\"xinxi\">\n                  <p style=\"  color: #000;\">QQ：</p>\n                  <p>{{ item.qq }}</p>\n                </div>\n                <div class=\"xinxi\">\n                  <p style=\"  color: #000;\">个人简介：</p>\n                  <p>{{ item.synopsis }}</p>\n                </div>\n                <el-button\n                  @click=\"jubao(item.username)\"\n                  style=\"margin:10px 150px\"\n                  type=\"danger\"\n                  plain\n                  >举报</el-button\n                >\n              </span>\n              <div slot=\"reference\">\n                <a href=\"#\">\n                  <img\n                    alt\n                    :src=\"item.avatar\"\n                    class=\"avatar touxiang avatar-60 photo\"\n                    height=\"40\"\n                    width=\"40\"\n                  />\n                </a>\n\n                <div class=\"comment-meta\">\n                  <h5 class=\"author\">\n                    <cite class=\"fn\">\n                      <a href=\"#\" rel=\"external nofollow\" class=\"url\">{{\n                        item.nickname\n                      }}</a>\n                    </cite>\n                  </h5>\n                  <p class=\"date\">\n                    <a href=\"#\">\n                      <time>{{ item.comment_createtime | dataFormat }}</time>\n                    </a>\n                  </p>\n                </div>\n              </div>\n            </el-popover>\n\n            <!-- end .comment-meta -->\n\n            <div class=\"comment-body\" v-html=\"item.comment_content\"></div>\n            <div class=\"comment-footer\">\n              <p @click=\"getreplybutton(item.comment_id, id)\">查看所有回复</p>\n              <p\n                @click=\"\n                  showinput(id, item.nickname, item.user_id, item.comment_id)\n                \"\n              >\n                回复\n              </p>\n            </div>\n            <div class=\"reply\" v-if=\"id === editorid\">\n              <vue-editor\n                useCustomImageHandler\n                @image-added=\"handleImageAdded\"\n                v-model=\"comment_content\"\n              ></vue-editor>\n              <div class=\"comment\">\n                <el-button type=\"info\" @click=\"setcomment\">评论</el-button>\n              </div>\n            </div>\n            <!-- end of comment-body -->\n          </article>\n          <!-- end of comment -->\n\n          <ul class=\"children\" v-if=\"id === replyid\">\n            <li\n              class=\"comment byuser comment-author-saqib-sarwar bypostauthor odd alt depth-2\"\n              id=\"li-comment-3\"\n              v-for=\"(data, index) in replylist\"\n              :key=\"index\"\n            >\n              <article id=\"comment-3\">\n                <el-popover placement=\"top\" width=\"400\" trigger=\"hover\">\n                  <span>\n                    <li\n                      class=\"comment even thread-odd thread-alt depth-1\"\n                      id=\"li-comment-4\"\n                    >\n                      <article id=\"comment-4\">\n                        <img\n                          :src=\"data.avatar\"\n                          class=\"avatar touxiang avatar-60 photo\"\n                          height=\"60\"\n                          width=\"60\"\n                        />\n                        <div class=\"comment-meta\">\n                          <h5 class=\"author\">{{ data.nickname }}</h5>\n\n                          <p class=\"date\" v-if=\"data.realstate == 3\">\n                            认证用户\n                          </p>\n                          <p class=\"date\" v-else>未认证用户</p>\n                        </div>\n                      </article>\n                    </li>\n                    <div class=\"xinxi\">\n                      <p style=\"  color: #000;\">账号：</p>\n                      <p>{{ data.username }}</p>\n                    </div>\n                    <div class=\"xinxi\">\n                      <p style=\"  color: #000;\">邮箱：</p>\n                      <p>{{ data.mail }}</p>\n                    </div>\n                    <div class=\"xinxi\">\n                      <p style=\"  color: #000;\">QQ：</p>\n                      <p>{{ data.qq }}</p>\n                    </div>\n                    <div class=\"xinxi\">\n                      <p style=\"  color: #000;\">个人简介：</p>\n                      <p>{{ data.synopsis }}</p>\n                    </div>\n                    <el-button\n                      @click=\"jubao(data.username)\"\n                      style=\"margin:10px 150px\"\n                      type=\"danger\"\n                      plain\n                      >举报</el-button\n                    >\n                  </span>\n                  <div slot=\"reference\">\n                    <a href=\"#\">\n                      <img\n                        alt\n                        :src=\"data.avatar\"\n                        class=\"avatar touxiang avatar-60 photo\"\n                        height=\"40\"\n                        width=\"40\"\n                      />\n                    </a>\n\n                    <div class=\"comment-meta\">\n                      <h5 class=\"author\">\n                        <cite class=\"fn\">\n                          <a href=\"#\" rel=\"external nofollow\" class=\"url\">{{\n                            data.nickname\n                          }}</a>\n                        </cite>\n                        @\n                        <a class=\"comment-reply-link touser\" href=\"#\">{{\n                          data.tousernickname\n                        }}</a>\n                      </h5>\n                      <p class=\"date\">\n                        <a href=\"#\">\n                          <time>{{\n                            data.comment_createtime | dataFormat\n                          }}</time>\n                        </a>\n                      </p>\n                    </div>\n                  </div>\n                </el-popover>\n\n                <!-- end .comment-meta -->\n\n                <div class=\"comment-body\" v-html=\"data.reply_content\"></div>\n                <!-- end of comment-body -->\n                <div class=\"comment-footer\">\n                  <p class=\"date\">\n                    <a href=\"#\">\n                      <time>{{ data.createtime | dataFormat }}</time>\n                    </a>\n                  </p>\n                  <p\n                    @click=\"\n                      showreplyinput(\n                        index,\n                        data.nickname,\n                        data.user_id,\n                        data.comment_id\n                      )\n                    \"\n                  >\n                    回复\n                  </p>\n                </div>\n                <div class=\"reply\" v-if=\"index === replyinputid\">\n                  <vue-editor\n                    useCustomImageHandler\n                    @image-added=\"handleImageAdded\"\n                    v-model=\"comment_content\"\n                  ></vue-editor>\n                  <div class=\"comment\">\n                    <el-button type=\"info\" @click=\"setcomment\">评论</el-button>\n                  </div>\n                </div>\n              </article>\n              <!-- end of comment -->\n            </li>\n          </ul>\n        </li>\n      </ol>\n    </section>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport { VueEditor } from 'vue2-editor'\n\nexport default {\n  components: {\n    VueEditor\n  },\n  computed: {\n    ...mapState({\n      avatar: state => state.user.userinfo.avatar,\n      nickname: state => state.user.userinfo.nickname,\n      contentid: state => state.contentid,\n      commentnum: state => state.commentnum,\n      contentname: state => state.contentname,\n      userinfo: state => state.userinfo,\n      contentuserid: state => state.contentuserid\n    })\n  },\n  data() {\n    return {\n      replyinputid: -1,\n      replyid: -1,\n      editorid: -2,\n      replylist: '',\n      commentid: '',\n      comment_id: '',\n      touserid: '',\n      tousernickname: '',\n\n      commentlist: {},\n      comment_content: ''\n    }\n  },\n  methods: {\n    jubao(username) {\n      let url = escape(window.location.href) //escape对url进行编码方便在地址栏传递\n      this.$router.push({\n        path: '/jubao',\n        query: { user: username, url: url }\n      })\n    },\n    ...mapActions(['setcommentnum']),\n    //\n    usercomment() {\n      this.editorid = -1\n      this.replyinputid = -2\n    },\n    //回复回复按钮\n    showreplyinput(index, tousernickname, touserid, comment_id) {\n      if (this.replyinputid == index) {\n        this.replyinputid = -2\n      } else {\n        this.touserid = touserid\n        this.tousernickname = tousernickname\n        this.replyinputid = index\n        this.editorid = -2\n        this.comment_id = comment_id\n      }\n    },\n    //回复按钮\n    showinput(id, tousernickname, touserid, comment_id) {\n      if (this.editorid == id) {\n        this.editorid = -2\n      } else {\n        this.touserid = touserid\n        this.tousernickname = tousernickname\n        this.editorid = id\n        this.replyinputid = -2\n        this.comment_id = comment_id\n      }\n    },\n    // reply(){\n    //   this.touserid='',\n    //   this.tousernickname='',\n    //   this.editorid= -1\n    // },\n    //富文本编辑器图片上传npm install vue2-editor\n    async handleImageAdded(file, Editor, cursorLocation, resetUploader) {\n      const formData = new FormData()\n      formData.append('file', file)\n      const res = await this.$axios.post('/uplod', formData)\n      console.log(res)\n      Editor.insertEmbed(cursorLocation, 'image', res.data.url)\n      resetUploader()\n    },\n    //获取回复按钮\n    getreplybutton(comment_id, id) {\n      this.replylist = ''\n      this.replyid = id\n      this.commentid = comment_id\n      this.getreply()\n    },\n    //获取回复\n    async getreply() {\n      let data = {\n        comment_id: this.commentid\n      }\n      let res = await this.$axios.post('/web/getreply', this.qs.stringify(data))\n      if (res.data.state.type === 'SUCCESS') {\n        this.replylist = res.data.data\n      }\n    },\n    //评论\n    async setcomment() {\n      let res\n      if (this.touserid != '') {\n        //回复\n        let data = {\n          comment_content: this.comment_content,\n          touserid: this.touserid,\n          tousernickname: this.tousernickname,\n          comment_id: this.comment_id,\n          router: this.$route.name,\n          to_userid: this.touserid,\n          content_id: this.contentid,\n          contentname: this.contentname\n        }\n        res = await this.$axios.post('/web/setreply', this.qs.stringify(data))\n        this.replyinputid = -1 //添加完评论时关闭回复框\n        this.getreply() //重新获取评论\n      } else {\n        //评论\n        let data = {\n          contentname: this.contentname,\n          comment_content: this.comment_content,\n          content_id: this.contentid,\n          router: this.$route.name,\n          to_userid: this.contentuserid\n        }\n        res = await this.$axios.post('/web/setcomment', this.qs.stringify(data))\n      }\n      if (res.data.state.type === 'SUCCESS') {\n        this.$message.success('评论成功')\n        this.comment_content = ''\n        this.touserid != ''\n        this.getcomment()\n        this.replyinputid = -1\n        this.replyid = -1\n        this.editorid = -2\n      }\n    },\n    //获取评论\n    async getcomment() {\n      let data = {\n        content_id: this.contentid\n      }\n      let res = await this.$axios.post(\n        '/web/getcomment',\n        this.qs.stringify(data)\n      )\n      if (res.data.state.type === 'SUCCESS') {\n        this.commentlist = res.data.data\n        console.log(this.commentlist)\n        this.setcommentnum(res.data.count)\n      }\n    }\n  },\n  created() {\n    this.getcomment()\n  }\n}\n</script>\n<style>\n.help {\n  min-height: 200px;\n}\n.comment {\n  margin-top: 10px;\n  margin-left: 20px;\n}\n.comment-footer {\n  height: 30px;\n  line-height: 30px;\n}\n.comment-footer p {\n  float: left;\n  margin-left: 20%;\n  font-size: 15px;\n}\n.commenttop {\n  margin-top: 20px;\n  font-size: 20px;\n  width: 100%;\n  text-align: center;\n  padding: 10px;\n  background-color: rgb(250, 244, 244);\n}\n\n.touser {\n  color: blue;\n}\n</style>\n"]}]}