{"remainingRequest":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js??vue-loader-options!E:\\download\\InterConnect\\admin\\src\\views\\check\\comment.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\download\\InterConnect\\admin\\src\\views\\check\\comment.vue","mtime":1641975356000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\download\\InterConnect\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1731663336609},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnY29tbWVudCcsCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKHsKICAgICAgdWluZm86IHN0YXRlID0+IHN0YXRlLnVzZXIudWluZm8KICAgIH0pCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCgogICAgICBwYWdlbGlzdHF1ZXJ5OiB7CiAgICAgICAgYWRtaW46ICcnLAogICAgICAgIHN0YXRlOiAnJywKICAgICAgICB0b3RhbDogMCwKICAgICAgICBwYWdlOiAxLAogICAgICAgIHBhZ2VzaXplOiAxMAogICAgICB9LAogICAgICB0YWJsZURhdGE6IFtdCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBnZXRyZXBseSgpIHsKICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMudGFibGVEYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRheGlvcy5wb3N0KAogICAgICAgICAgJy9hZG1pbi9nZXRyZXBseScsCiAgICAgICAgICB0aGlzLnFzLnN0cmluZ2lmeSh7IGNvbW1lbnRfaWQ6IHRoaXMudGFibGVEYXRhW2luZGV4XS5jb21tZW50X2lkIH0pCiAgICAgICAgKQogICAgICAgIGlmIChyZXMuZGF0YS5zdGF0ZS50eXBlID09PSAnU1VDQ0VTUycpIHsKICAgICAgICAgIHRoaXMudGFibGVEYXRhW2luZGV4XS5jaGlsZCA9IHJlcy5kYXRhLmRhdGEKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBjaGFuZ2VzdGF0ZSh0eXBlLCBzdGF0ZSwgaWQpIHsKICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgaWQ6IGlkLAogICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgc3RhdGU6IHN0YXRlCiAgICAgIH0KICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuJGF4aW9zLnBvc3QoCiAgICAgICAgJy9hZG1pbi9jaGFuZ2Vjb250ZW50c3RhdGUnLAogICAgICAgIHRoaXMucXMuc3RyaW5naWZ5KGRhdGEpCiAgICAgICkKICAgICAgaWYgKHJlcy5kYXRhLnN0YXRlLnR5cGUgPT09ICdTVUNDRVNTJykgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5pON5L2c5oiQ5YqfJykKICAgICAgICB0aGlzLmdldGNvbW1lbnRsaXN0KCkKICAgICAgICB0aGlzLmRpYWxvZyA9IGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVTaXplQ2hhbmdlKHZhbCkgewogICAgICB0aGlzLnBhZ2VsaXN0cXVlcnkucGFnZXNpemUgPSB2YWwKICAgICAgdGhpcy5nZXRjb21tZW50bGlzdCgpCiAgICB9LAogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5wYWdlbGlzdHF1ZXJ5LnBhZ2UgPSB2YWwKICAgICAgdGhpcy5nZXRjb21tZW50bGlzdCgpCiAgICB9LAogICAgYXN5bmMgZGVsKGlkLCB0eXBlKSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGlkOiBpZCwKICAgICAgICB0eXBlOiB0eXBlCiAgICAgIH0KICAgICAgICB0aGlzLiRjb25maXJtKCfnoa7orqTliKDpmaTlkJc/JywgJ+aPkOekuicsIHsKICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QoCiAgICAgICAgICAnL2FkbWluL2FkbWluZGVsZXRlJywKICAgICAgICAgIHRoaXMucXMuc3RyaW5naWZ5KGRhdGEpCiAgICAgICAgKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXRlLnR5cGUgPT09ICdTVUNDRVNTJykgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfliKDpmaTmiJDlip8nKQogICAgICAgICAgdGhpcy5nZXRjb21tZW50bGlzdCgpCiAgICAgICAgfQogICAgICAgIH0pCgogICAgICAgICAgfSkKICAgIH0sCiAgICBhc3luYyBnZXRjb21tZW50bGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgKICAgICAgICAnL2FkbWluL2dldGNvbW1lbnQnLAogICAgICAgIHRoaXMucXMuc3RyaW5naWZ5KHRoaXMucGFnZWxpc3RxdWVyeSkKICAgICAgKQogICAgICBpZiAocmVzLmRhdGEuc3RhdGUudHlwZSA9PT0gJ1NVQ0NFU1MnKSB7CiAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgdGhpcy5wYWdlbGlzdHF1ZXJ5LnRvdGFsID0gcmVzLmRhdGEuY291bnQKICAgICAgICB0aGlzLmdldHJlcGx5KCkKICAgICAgfQogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Y29tbWVudGxpc3QoKQogIH0KfQo="},{"version":3,"sources":["comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2NA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"comment.vue","sourceRoot":"src/views/check","sourcesContent":["<template>\n  <div class=\"comment\">\n    <el-main>\n      <div class=\"top\">\n        <el-breadcrumb separator=\"/\">\n          <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\n          <el-breadcrumb-item>审核中心</el-breadcrumb-item>\n          <el-breadcrumb-item>评论审核</el-breadcrumb-item>\n        </el-breadcrumb>\n      </div>\n\n      <div class=\"main\">\n        <div class=\"search\">\n          <el-form\n            :inline=\"true\"\n            :model=\"pagelistquery\"\n            class=\"demo-form-inline\"\n          >\n            <el-form-item>\n              <el-input\n                v-model=\"pagelistquery.admin\"\n                placeholder=\"审批人\"\n              ></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-select v-model=\"pagelistquery.state\" placeholder=\"状态\">\n                <el-option label=\"全部\" value></el-option>\n                <el-option label=\"待审核\" value=\"0\"></el-option>\n                <el-option label=\"审核通过\" value=\"1\"></el-option>\n\n                <el-option label=\"审核未通过\" value=\"-1\"></el-option>\n              </el-select>\n            </el-form-item>\n\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"getcommentlist\">查询</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n\n        <el-table\n          :data=\"tableData\"\n          border\n          style=\"width: 100%;min-height:500px\"\n          v-loading=\"loading\"\n          element-loading-text=\"拼命加载中\"\n          element-loading-spinner=\"el-icon-loading\"\n        >\n          <!-- @expand-change=\"getreply\" -->\n          <el-table-column type=\"expand\">\n            <template slot-scope=\"props\">\n              <el-table :data=\"props.row.child\" style=\"width: 100%\">\n                <el-table-column type=\"index\" width=\"50\"></el-table-column>\n                <el-table-column prop=\"createtime\" label=\"创建日期\">\n                  <template slot-scope=\"scope\">{{\n                    scope.row.comment_createtime | dataFormat\n                  }}</template>\n                </el-table-column>\n                <el-table-column\n                  label=\"回复者\"\n                  prop=\"nickname\"\n                ></el-table-column>\n                <el-table-column\n                  label=\"被回复者\"\n                  prop=\"tousernickname\"\n                ></el-table-column>\n                <el-table-column label=\"状态\" prop=\"comment_ispublic\">\n                  <template slot-scope=\"scope\">\n                    <span style=\"color:#6cbb7a\" v-if=\"scope.row.ispublic == 1\"\n                      >审核通过</span\n                    >\n                    <span style=\"color:#409eff\" v-if=\"scope.row.ispublic == 0\"\n                      >未审核</span\n                    >\n                    <span style=\"color:#f60c6c\" v-if=\"scope.row.ispublic == -1\"\n                      >审核未通过</span\n                    >\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"回复内容\" prop=\"desc\">\n                  <template slot-scope=\"scope\">\n                    <el-popover placement=\"right\" width=\"400\" trigger=\"hover\">\n                      <span v-html=\"scope.row.reply_content\"></span>\n                      <el-button type=\"text\" slot=\"reference\"\n                        >回复类容</el-button\n                      >\n                    </el-popover>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"审核人\" prop=\"admin\"></el-table-column>\n\n                <el-table-column fixed=\"right\" label=\"操作\" width=\"250\">\n                  <template slot-scope=\"scope\">\n                    <el-button\n                      type=\"text\"\n                      size=\"small\"\n                      v-if=\"scope.row.ispublic == 1\"\n                      @click=\"changestate('reply', -1, scope.row.reply_id)\"\n                      >不通过审核</el-button\n                    >\n                    <el-button\n                      type=\"text\"\n                      size=\"small\"\n                      v-if=\"scope.row.ispublic == 0\"\n                      @click=\"changestate('reply', 1, scope.row.reply_id)\"\n                      >通过审核</el-button\n                    >\n                    <el-button\n                      type=\"text\"\n                      size=\"small\"\n                      v-if=\"scope.row.ispublic == 0\"\n                      @click=\"changestate('reply', -1, scope.row.reply_id)\"\n                      >不通过审核</el-button\n                    >\n                    <el-button\n                      type=\"text\"\n                      size=\"small\"\n                      v-if=\"scope.row.ispublic == -1\"\n                      @click=\"changestate('reply', 1, scope.row.reply_id)\"\n                      >通过审核</el-button\n                    >\n                    <el-button\n                      type=\"text\"\n                      size=\"small\"\n                      @click=\"del(scope.row.reply_id, 'reply')\"\n                      :disabled=\"uinfo.username !== 'admin'\"\n                      >删除</el-button\n                    >\n                  </template>\n                </el-table-column>\n              </el-table>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"createtime\" label=\"创建日期\">\n            <template slot-scope=\"scope\">{{\n              scope.row.comment_createtime | dataFormat\n            }}</template>\n          </el-table-column>\n          <el-table-column label=\"评论者\" prop=\"nickname\"></el-table-column>\n          <el-table-column label=\"状态\" prop=\"comment_ispublic\">\n            <template slot-scope=\"scope\">\n              <span style=\"color:#6cbb7a\" v-if=\"scope.row.ispublic == 1\"\n                >审核通过</span\n              >\n              <span style=\"color:#409eff\" v-if=\"scope.row.ispublic == 0\"\n                >未审核</span\n              >\n              <span style=\"color:#f60c6c\" v-if=\"scope.row.ispublic == -1\"\n                >审核未通过</span\n              >\n            </template>\n          </el-table-column>\n          <el-table-column label=\"评论内容\" prop=\"desc\">\n            <template slot-scope=\"scope\">\n              <el-popover placement=\"right\" width=\"400\" trigger=\"hover\">\n                <span v-html=\"scope.row.comment_content\"></span>\n                <el-button type=\"text\" slot=\"reference\">评论类容</el-button>\n              </el-popover>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"审核人\" prop=\"admin\"></el-table-column>\n\n          <el-table-column fixed=\"right\" label=\"操作\" width=\"250\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                v-if=\"scope.row.ispublic == 1\"\n                @click=\"changestate('comment', -1, scope.row.comment_id)\"\n                >不通过审核</el-button\n              >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                v-if=\"scope.row.ispublic == 0\"\n                @click=\"changestate('comment', 1, scope.row.comment_id)\"\n                >通过审核</el-button\n              >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                v-if=\"scope.row.ispublic == 0\"\n                @click=\"changestate('comment', -1, scope.row.comment_id)\"\n                >不通过审核</el-button\n              >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                v-if=\"scope.row.ispublic == -1\"\n                @click=\"changestate('comment', 1, scope.row.comment_id)\"\n                >通过审核</el-button\n              >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                @click=\"del(scope.row.comment_id, 'comment')\"\n                :disabled=\"uinfo.username !== 'admin'\"\n                >删除</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n\n        <!--分页-->\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          :page-size=\"pagelistquery.pagesize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"pagelistquery.total\"\n          style=\"margin-top: 20px;\"\n        ></el-pagination>\n      </div>\n    </el-main>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\n\nexport default {\n  name: 'comment',\n  computed: {\n    ...mapState({\n      uinfo: state => state.user.uinfo\n    })\n  },\n  data() {\n    return {\n      loading: false,\n\n      pagelistquery: {\n        admin: '',\n        state: '',\n        total: 0,\n        page: 1,\n        pagesize: 10\n      },\n      tableData: []\n    }\n  },\n  methods: {\n    async getreply() {\n      for (let index = 0; index < this.tableData.length; index++) {\n        let res = await this.$axios.post(\n          '/admin/getreply',\n          this.qs.stringify({ comment_id: this.tableData[index].comment_id })\n        )\n        if (res.data.state.type === 'SUCCESS') {\n          this.tableData[index].child = res.data.data\n        }\n      }\n    },\n    async changestate(type, state, id) {\n      let data = {\n        id: id,\n        type: type,\n        state: state\n      }\n      let res = await this.$axios.post(\n        '/admin/changecontentstate',\n        this.qs.stringify(data)\n      )\n      if (res.data.state.type === 'SUCCESS') {\n        this.$message.success('操作成功')\n        this.getcommentlist()\n        this.dialog = false\n      }\n    },\n    handleSizeChange(val) {\n      this.pagelistquery.pagesize = val\n      this.getcommentlist()\n    },\n    handleCurrentChange(val) {\n      this.pagelistquery.page = val\n      this.getcommentlist()\n    },\n    async del(id, type) {\n      let data = {\n        id: id,\n        type: type\n      }\n        this.$confirm('确认删除吗?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(() => {\n          this.$axios.post(\n          '/admin/admindelete',\n          this.qs.stringify(data)\n        ).then(res => {\n        if (res.data.state.type === 'SUCCESS') {\n          this.$message.success('删除成功')\n          this.getcommentlist()\n        }\n        })\n\n          })\n    },\n    async getcommentlist() {\n      this.loading = true\n      let res = await this.$axios.post(\n        '/admin/getcomment',\n        this.qs.stringify(this.pagelistquery)\n      )\n      if (res.data.state.type === 'SUCCESS') {\n        this.tableData = res.data.data\n        this.pagelistquery.total = res.data.count\n        this.getreply()\n      }\n      this.loading = false\n    }\n  },\n  created() {\n    this.getcommentlist()\n  }\n}\n</script>\n<style scoped>\n.top {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: calc(100% - 35px);\n  padding: 12px 16px;\n  background-color: #fff;\n}\n.comment {\n  position: relative;\n  width: 100%;\n}\n.main {\n  margin-top: 40px;\n  padding: 20px;\n  background-color: #fff;\n}\n</style>\n"]}]}