{"remainingRequest":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js??vue-loader-options!E:\\download\\InterConnect\\admin\\src\\views\\usermanage\\useruser.vue?vue&type=style&index=0&id=e16e98aa&scoped=true&lang=css","dependencies":[{"path":"E:\\download\\InterConnect\\admin\\src\\views\\usermanage\\useruser.vue","mtime":1641975356000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\postcss-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\download\\InterConnect\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1731663336609},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnRvcCB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMDsKICBsZWZ0OiAwOwogIHdpZHRoOiBjYWxjKDEwMCUgLSAzNXB4KTsKICBwYWRkaW5nOiAxMnB4IDE2cHg7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKfQoudXNlcnVzZXIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB3aWR0aDogMTAwJTsKfQoubWFpbiB7CiAgbWFyZ2luLXRvcDogNDBweDsKICBwYWRkaW5nOiAyMHB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7Cn0K"},{"version":3,"sources":["useruser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"useruser.vue","sourceRoot":"src/views/usermanage","sourcesContent":["<template>\n  <div class=\"useruser\">\n    <el-main>\n      <div class=\"top\">\n        <el-breadcrumb separator=\"/\">\n          <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\n          <el-breadcrumb-item>用户管理</el-breadcrumb-item>\n          <el-breadcrumb-item>普通用户管理</el-breadcrumb-item>\n        </el-breadcrumb>\n      </div>\n\n      <div class=\"main\">\n        <div class=\"search\">\n          <el-form :inline=\"true\" :model=\"pagelistquery\" class=\"demo-form-inline\">\n            <el-form-item>\n              <el-input v-model=\"pagelistquery.user\" placeholder=\"账号查找\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-select v-model=\"pagelistquery.realstate\" placeholder=\"实名认证状态\">\n                <el-option label=\"全部\" value></el-option>\n                <el-option label=\"未认证\" value=\"1\"></el-option>\n                <el-option label=\"待认证\" value=\"2\"></el-option>\n                <el-option label=\"认证通过\" value=\"3\"></el-option>\n                <el-option label=\"认证失败\" value=\"-1\"></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item>\n              <el-select v-model=\"pagelistquery.companystate\" placeholder=\"公司认证状态\">\n                <el-option label=\"全部\" value></el-option>\n                <el-option label=\"未认证\" value=\"1\"></el-option>\n                <el-option label=\"待认证\" value=\"2\"></el-option>\n                <el-option label=\"认证通过\" value=\"3\"></el-option>\n                <el-option label=\"认证失败\" value=\"-1\"></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"getuserlist\">查询</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n        <el-table\n          v-loading=\"loading\"\n          element-loading-text=\"拼命加载中\"\n          element-loading-spinner=\"el-icon-loading\"\n          :data=\"tableData\"\n          border\n          style=\"width: 100%;min-height:500px\"\n        >\n          <el-table-column prop=\"username\" label=\"账号\"></el-table-column>\n          <el-table-column prop=\"nickname\" label=\"昵称\"></el-table-column>\n          <el-table-column prop=\"realstate\" label=\"实名认证状态\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"text\"\n                @click=\"changerealstatedialog(scope.row)\"\n              >{{ scope.row.realstate |userstatefilter}}</el-button>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"companystate\" label=\"公司认证状态\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"text\"\n                @click=\"changecompanystatedialog(scope.row)\"\n              >{{ scope.row.companystate |userstatefilter}}</el-button>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"activationdate\" label=\"启用时间\">\n            <template slot-scope=\"scope\">{{ scope.row.activationdate | dataFormat }}</template>\n          </el-table-column>\n          <el-table-column fixed=\"right\" label=\"操作\" width=\"170\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                :disabled=\"uinfo.username !== 'admin'\"\n                @click=\"activationdate(scope.row)\"\n              >封禁解封</el-button>\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                :disabled=\"uinfo.username !== 'admin'\"\n                @click=\"deleteuser(scope.row)\"\n              >删除</el-button>\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                :disabled=\"scope.row.username== 'admin'||uinfo.username !== 'admin'\"\n                @click=\"changepw(scope.row)\"\n              >修改密码</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n        <!--密码框-->\n        <el-dialog title=\"输入新的密码\" :visible.sync=\"dialogpw\" width=\"500px\">\n          <el-form :model=\"changepassword\">\n            <el-form-item label=\"账号\" label-width=\"100px\">{{changepassword.username}}</el-form-item>\n            <el-form-item label=\"新密码\" label-width=\"100px\">\n              <el-input v-model=\"changepassword.newpassword\" autocomplete=\"off\"></el-input>\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogpw = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"change\">确 定</el-button>\n          </div>\n        </el-dialog>\n        <!--公司信息认证-->\n        <el-dialog title=\"公司信息认证\" :visible.sync=\"dialogcompany\">\n          <div v-if=\"changecompanystateuser.companystate===1\">\n            <img src=\"../../assets/img/noinfo.png\" width=\"100%\" alt />\n            <div style=\"width:100%;text-align:center\">该用户还没有添加公司认证信息</div>\n          </div>\n          <el-form v-else>\n            <el-form-item label=\"公司名称\">{{changecompanystateuser.companyname}}</el-form-item>\n            <el-form-item label=\"相关信息图片\">\n              <img\n                v-for=\"(img,id) in changecompanystateuser.companyimg\"\n                style=\"width:40% ;margin:20px\"\n                :key=\"id\"\n                :src=\"img.url\"\n                alt\n              />\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\" v-if=\"changecompanystateuser.companystate===1\">\n            <el-button @click=\"dialogcompany = false\">取消</el-button>\n          </div>\n          <div slot=\"footer\" v-else class=\"dialog-footer\">\n            <el-button\n              type=\"primary\"\n              v-if=\"changecompanystateuser.companystate!==3\"\n              @click=\"changestate('companystate',3,changecompanystateuser.user_id,changecompanystateuser.companyname)\"\n            >通过认证</el-button>\n            <el-button\n              type=\"danger\"\n              @click=\"changestate('companystate',0,changecompanystateuser.user_id)\"\n            >不通过认证</el-button>\n            <el-button @click=\"dialogcompany = false\">取消</el-button>\n          </div>\n        </el-dialog>\n        <!--用户信息认证-->\n        <el-dialog title=\"用户认证信息\" :visible.sync=\"dialogstudent\">\n          <div v-if=\"changerealstateuser.realstate===1\">\n            <img src=\"../../assets/img/noinfo.png\" width=\"100%\" alt />\n            <div style=\"width:100%;text-align:center\">该用户还没有添加认证信息</div>\n          </div>\n          <el-form v-else>\n            <el-form-item label=\"学号\">{{changerealstateuser.realname}}</el-form-item>\n            <el-form-item label=\"姓名\">{{changerealstateuser.studentid}}</el-form-item>\n            <el-form-item label=\"学生证\">\n              <img\n                v-for=\"(img,id) in changerealstateuser.studentcard\"\n                style=\"width:40% ;margin:20px\"\n                :key=\"id\"\n                :src=\"img.url\"\n                alt\n              />\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\" v-if=\"changerealstateuser.realstate===1\">\n            <el-button @click=\"dialogstudent = false\">取消</el-button>\n          </div>\n          <div slot=\"footer\" v-else class=\"dialog-footer\">\n            <el-button\n              type=\"primary\"\n              v-if=\"changerealstateuser.realstate!==3\"\n              @click=\"changestate('realstate',3,changerealstateuser.user_id)\"\n            >通过认证</el-button>\n            <el-button\n              type=\"danger\"\n              @click=\"changestate('realstate',0,changerealstateuser.user_id)\"\n            >不通过认证</el-button>\n            <el-button @click=\"dialogstudent = false\">取消</el-button>\n          </div>\n        </el-dialog>\n        <el-dialog title=\"封禁时间(天)\" :visible.sync=\"activationttime.dialog\" width=\"500px\">\n          <el-form :model=\"activationttime\">\n            <el-form-item label>\n              <el-input v-model=\"activationttime.time\"></el-input>\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"activationttime.dialog = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"changeactivationdate\">确 定</el-button>\n          </div>\n        </el-dialog>\n        <!--分页-->\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          :page-size=\"pagelistquery.pagesize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"pagelistquery.total\"\n          style=\"margin-top: 20px;\"\n        ></el-pagination>\n      </div>\n    </el-main>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from \"vuex\";\n\nexport default {\n  name: \"useruser\",\n  data() {\n    return {\n      changepassword: {}, //修改密码弹窗数据\n      changerealstateuser: {}, //正在审核的用户信息\n      changecompanystateuser: {}, //公司认证信息\n      dialogstudent: false,\n      dialogcompany: false,\n      dialogpw: false, //密码框\n      loading: false,\n      pagelistquery: {\n        realstate: \"\",\n        companystate: \"\",\n        total: 0,\n        page: 1,\n        pagesize: 10,\n        user: \"\",\n\n      },\n      tableData: [], //列表信息\n\n      activationttime: {\n        time: 0,\n        userid: \"\",\n        jubao_id: \"\",\n        dialog: false //密码框\n      }\n    };\n  },\n  computed: {\n    ...mapState({\n      uinfo: state => state.user.uinfo\n    })\n  },\n  filters: {\n    userstatefilter(state) {\n      if (state == 3) {\n        return \"认证成功\";\n      }\n      if (state == 2) {\n        return \"待审核\";\n      }\n      if (state == 1) {\n        return \"未认证\";\n      }\n      if (state == 0) {\n        return \"认证失败\";\n      }\n    }\n  },\n  methods: {\n    activationdate(row) {\n      this.activationttime.userid = row.user_id;\n      this.activationttime.dialog = true;\n    },\n    //修改账号封禁时间\n    async changeactivationdate() {\n      this.changepassword.type = \"adminuser\";\n      let res = await this.$axios.post(\n        \"/admin/changeactivationdate\",\n        this.qs.stringify(this.activationttime)\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        this.$message.success(\"操作成功\");\n        this.getuserlist();\n        this.activationttime.dialog = false;\n      }\n    },\n    async changestate(type, state, userid, companyname) {\n      let data = {\n        type: type,\n        state: state,\n        user_id: userid,\n        company_name: companyname\n      };\n      let res = await this.$axios.post(\n        \"/admin/changeuserstate\",\n        this.qs.stringify(data)\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        this.$message.success(\"操作成功成功\");\n        this.getuserlist();\n        this.dialogstudent = false;\n        this.dialogcompany = false;\n      }\n    },\n    changepw(row) {\n      console.log(111);\n      this.dialogpw = true;\n      this.changepassword = row;\n    },\n    //修改密码\n    async change() {\n      this.changepassword.type = \"adminuser\";\n      let res = await this.$axios.post(\n        \"/admin/changepassword\",\n        this.qs.stringify(this.changepassword)\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        this.$message.success(\"修改成功\");\n        this.dialogpw = false;\n      }\n    },\n    //删除用户\n\n    async deleteuser(row) {\n      let data = {\n        user_id: row.user_id,\n        usertype: \"user\"\n      };\n        this.$confirm('确认删除吗?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.$axios.post(\n            \"/admin/deleteuser\",\n            this.qs.stringify(data)\n          ).then(res => {\n            if (res.data.state.type === \"SUCCESS\") {\n              this.$message.success(\"删除成功\");\n              this.dialogpw = false;\n              this.getuserlist();\n            }\n          })\n        })\n    },\n    //用户状态修改\n    async changeuseruserstate(row) {\n      console.log(row);\n      let res = await this.$axios.post(\n        \"/admin/changeuseruserstate\",\n        this.qs.stringify(row)\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        this.$message.success(\"状态修改成功\");\n      }\n    },\n    //公司认证信息\n    changecompanystatedialog(user) {\n      this.changecompanystateuser = JSON.stringify(user);\n      this.changecompanystateuser = JSON.parse(this.changecompanystateuser);\n      this.changecompanystateuser.companyimg = JSON.parse(\n        this.changecompanystateuser.companyimg\n      );\n      this.dialogcompany = true;\n    },\n    //学生认证信息\n    changerealstatedialog(user) {\n      console.log(user);\n      this.changerealstateuser = JSON.stringify(user);\n      this.changerealstateuser = JSON.parse(this.changerealstateuser);\n      this.changerealstateuser.studentcard = JSON.parse(\n        this.changerealstateuser.studentcard\n      );\n      this.dialogstudent = true;\n    },\n\n    handleSizeChange(val) {\n      this.pagelistquery.pagesize = val;\n      this.getuserlist();\n      console.log(`每页 ${val} 条`);\n    },\n    handleCurrentChange(val) {\n      this.pagelistquery.page = val;\n      this.getuserlist();\n      console.log(`当前页: ${val}`);\n    },\n    async getuserlist() {\n      console.log(this.pagelistquery)\n      this.loading = true;\n      let res = await this.$axios.post(\n        \"/admin/getuserlist\",\n        this.qs.stringify(this.pagelistquery)\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        this.tableData = res.data.data;\n        console.log(res.data);\n        this.pagelistquery.total = res.data.count;\n        this.loading = false;\n      }\n    },\n    jubao() {\n      console.log(1)\n      this.pagelistquery.user = this.$route.query.user;\n      this.activationttime.jubao_id = this.$route.query.jubao_id;\n    }\n  },\n  created() {\n    this.$route.query .user&& this.jubao();\n    this.getuserlist();\n  }\n};\n</script>\n<style  scoped>\n.top {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: calc(100% - 35px);\n  padding: 12px 16px;\n  background-color: #fff;\n}\n.useruser {\n  position: relative;\n  width: 100%;\n}\n.main {\n  margin-top: 40px;\n  padding: 20px;\n  background-color: #fff;\n}\n</style>\n"]}]}