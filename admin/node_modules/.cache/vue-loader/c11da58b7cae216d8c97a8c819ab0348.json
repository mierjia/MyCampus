{"remainingRequest":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js??vue-loader-options!E:\\download\\InterConnect\\admin\\src\\views\\usermanage\\useradmin.vue?vue&type=style&index=0&id=497edc9f&scoped=true&lang=css","dependencies":[{"path":"E:\\download\\InterConnect\\admin\\src\\views\\usermanage\\useradmin.vue","mtime":1641975356000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\postcss-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\download\\InterConnect\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1731663336609},{"path":"E:\\download\\InterConnect\\admin\\node_modules\\@vue\\cli-service\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnRvcCB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMDsKICBsZWZ0OiAwOwogIHdpZHRoOiBjYWxjKDEwMCUgLSAzNXB4KTsKICBwYWRkaW5nOiAxMnB4IDE2cHg7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKfQoudXNlcnVzZXIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB3aWR0aDogMTAwJTsKfQoubWFpbiB7CiAgbWFyZ2luLXRvcDogNDBweDsKICBwYWRkaW5nOiAyMHB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7Cn0K"},{"version":3,"sources":["useradmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"useradmin.vue","sourceRoot":"src/views/usermanage","sourcesContent":["<template>\n  <div class=\"useruser\">\n    <el-main>\n      <div class=\"top\">\n        <el-breadcrumb separator=\"/\">\n          <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\n          <el-breadcrumb-item>用户管理</el-breadcrumb-item>\n          <el-breadcrumb-item>管理员用户管理</el-breadcrumb-item>\n        </el-breadcrumb>\n      </div>\n\n      <div class=\"main\">\n        <div class=\"search\">\n          <el-form\n            :inline=\"true\"\n            :model=\"pagelistquery\"\n            class=\"demo-form-inline\"\n          >\n            <el-form-item>\n              <el-input\n                v-model=\"pagelistquery.user\"\n                placeholder=\"账号模糊查找\"\n              ></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-select v-model=\"pagelistquery.state\" placeholder=\"账号状态\">\n                <el-option label=\"启用\" value=\"1\"></el-option>\n                <el-option label=\"停用\" value=\"0\"></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"getadminlist\">查询</el-button>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"dialogFormVisibleadd = true\"\n                >添加账号</el-button\n              >\n            </el-form-item>\n          </el-form>\n        </div>\n        <el-dialog\n          title=\"添加新的账号\"\n          :visible.sync=\"dialogFormVisibleadd\"\n          width=\"500px\"\n        >\n          <el-form :model=\"form\">\n            <el-form-item label=\"账号\" label-width=\"100px\">\n              <el-input v-model=\"user.username\" autocomplete=\"off\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"密码\" label-width=\"100px\">\n              <el-input\n                type=\"password\"\n                v-model=\"user.password\"\n                autocomplete=\"off\"\n              ></el-input>\n            </el-form-item>\n            <el-form-item label=\"确认密码\" label-width=\"100px\">\n              <el-input\n                type=\"password\"\n                v-model=\"user.password1\"\n                autocomplete=\"off\"\n              ></el-input>\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogFormVisibleadd = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"registered\">确 定</el-button>\n          </div>\n        </el-dialog>\n\n        <el-dialog title=\"输入新的密码\" :visible.sync=\"dialogpw\" width=\"500px\">\n          <el-form :model=\"changepassword\">\n            <el-form-item label=\"账号\" label-width=\"100px\">{{\n              changepassword.username\n            }}</el-form-item>\n            <el-form-item label=\"新密码\" label-width=\"100px\">\n              <el-input\n                v-model=\"changepassword.newpassword\"\n                autocomplete=\"off\"\n              ></el-input>\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogpw = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"change\">确 定</el-button>\n          </div>\n        </el-dialog>\n\n        <el-table\n          :data=\"tableData\"\n          border\n          style=\"width: 100%;min-height:500px\"\n          v-loading=\"loading\"\n          element-loading-text=\"拼命加载中\"\n          element-loading-spinner=\"el-icon-loading\"\n        >\n          <el-table-column prop=\"username\" label=\"账号\"></el-table-column>\n          <el-table-column prop=\"nickname\" label=\"昵称\"></el-table-column>\n          <el-table-column prop=\"nickname\" label=\"审核中心\">\n            <template slot-scope=\"scope\">\n              <el-switch\n                @click.native.prevent=\"changestate(scope.row)\"\n                v-model=\"scope.row.issh\"\n                active-color=\"#13ce66\"\n                inactive-color=\"#ff4949\"\n                active-value=\"1\"\n                inactive-value=\"0\"\n              ></el-switch>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"nickname\" label=\"用户管理\">\n            <template slot-scope=\"scope\">\n              <el-switch\n                @click.native.prevent=\"changestate(scope.row)\"\n                v-model=\"scope.row.isyh\"\n                active-color=\"#13ce66\"\n                inactive-color=\"#ff4949\"\n                active-value=\"1\"\n                inactive-value=\"0\"\n              ></el-switch>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"nickname\" label=\"网站管理中心\">\n            <template slot-scope=\"scope\">\n              <el-switch\n                @click.native.prevent=\"changestate(scope.row)\"\n                v-model=\"scope.row.isgl\"\n                active-color=\"#13ce66\"\n                inactive-color=\"#ff4949\"\n                active-value=\"1\"\n                inactive-value=\"0\"\n              ></el-switch>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"nickname\" label=\"反馈中心\">\n            <template slot-scope=\"scope\">\n              <el-switch\n                @click.native.prevent=\"changestate(scope.row)\"\n                v-model=\"scope.row.isfk\"\n                active-color=\"#13ce66\"\n                inactive-color=\"#ff4949\"\n                active-value=\"1\"\n                inactive-value=\"0\"\n              ></el-switch>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"nickname\" label=\"账号状态\">\n            <template slot-scope=\"scope\">\n              <el-switch\n                @click.native.prevent=\"changestate(scope.row)\"\n                v-model=\"scope.row.user_state\"\n                active-color=\"#13ce66\"\n                inactive-color=\"#ff4949\"\n                active-value=\"1\"\n                inactive-value=\"0\"\n              ></el-switch>\n            </template>\n          </el-table-column>\n\n          <el-table-column\n            prop=\"nickname\"\n            fixed=\"right\"\n            label=\"操作\"\n            width=\"170\"\n          >\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                :disabled=\"scope.row.username == 'admin'\"\n                @click=\"deleteuser(scope.row)\"\n                >删除</el-button\n              >\n              <el-button\n                type=\"text\"\n                :disabled=\"scope.row.username == 'admin'\"\n                size=\"small\"\n                @click=\"changepw(scope.row)\"\n                >修改密码</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n\n        <!--分页-->\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          :page-size=\"pagelistquery.pagesize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"pagelistquery.total\"\n          style=\"margin-top: 20px;\"\n        ></el-pagination>\n      </div>\n    </el-main>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'admin',\n  data() {\n    return {\n      changepassword: {},\n      dialogpw: false, //密码框\n      loading: false,\n      dialogFormVisibleadd: false, //添加弹框\n      form: {},\n      user: {\n        username: '',\n        password: '',\n        password1: ''\n      },\n      pagelistquery: {\n        total: 0,\n        page: 1,\n        pagesize: 10,\n        user: '',\n        state: ''\n      },\n      tableData: [] //列表信息\n    }\n  },\n  methods: {\n    registered() {\n      const userReg = /^[1-9a-zA-Z]{1}[0-9a-zA-Z]{5,9}$/ //6-10位字母数字\n      const pwdReg = /^[a-zA-Z]\\w{5,17}$/ //6-18位字母数字下划线 字母开头\n      if (!userReg.test(this.user.username)) {\n        this.$message.error('账号为6-10位字母数字字母')\n        return\n      }\n      if (!pwdReg.test(this.user.password)) {\n        this.$message.error('密码为6-18位字母数字或下划线 字母开头')\n        return\n      }\n      if (this.user.password !== this.user.password1) {\n        this.$message.error('两次密码不相等')\n        return\n      }\n      this.$axios({\n        url: '/admin/registered',\n        method: 'POST',\n        data: this.qs.stringify(this.user)\n      })\n        .then(res => {\n          let data = res.data\n          if (data.state.type !== 'SUCCESS') {\n            if (data.state.type == 'ERROR_PARAMS_EXIST') {\n              this.$message.error('账户名重复')\n            } else {\n              this.$message.error('账号添加失败失败')\n            }\n            return\n          }\n          this.$message.success('账号添加成功')\n          this.dialogFormVisibleadd = false\n          this.getadminlist()\n        })\n        .catch(e => {\n          this.$message.error(e)\n        })\n    },\n    async changestate(row) {\n      let res = await this.$axios.post(\n        '/admin/changeadminstate',\n        this.qs.stringify(row)\n      )\n      if (res.data.state.type === 'SUCCESS') {\n        this.$message.success('更改授权成功')\n      }\n    },\n    changepw(row) {\n      this.dialogpw = true\n      this.changepassword = row\n    },\n    //修改密码\n    async change() {\n      this.changepassword.type = 'adminadmin'\n      let res = await this.$axios.post(\n        '/admin/changepassword',\n        this.qs.stringify(this.changepassword)\n      )\n      if (res.data.state.type === 'SUCCESS') {\n        this.$message.success('修改成功')\n        this.dialogpw = false\n      }\n    },\n    //删除用户\n\n    async deleteuser(row) {\n      let data = {\n        user_id: row.user_id,\n        usertype: 'admin'\n      }\n        this.$confirm('确认删除吗?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.$axios.post(\n            '/admin/deleteuser',\n            this.qs.stringify(data)\n          ).then(res => {\n            if (res.data.state.type === 'SUCCESS') {\n              this.$message.success('删除成功')\n              this.getadminlist()\n            }\n          })\n        })\n    },\n    handleSizeChange(val) {\n      this.pagelistquery.pagesize = val\n      this.getadminlist()\n    },\n    handleCurrentChange(val) {\n      this.pagelistquery.page = val\n      this.getadminlist()\n    },\n    async getadminlist() {\n      this.loading = true\n      let res = await this.$axios.post(\n        '/admin/getadminlist',\n        this.qs.stringify(this.pagelistquery)\n      )\n      if (res.data.state.type === 'SUCCESS') {\n        this.tableData = res.data.data\n        this.pagelistquery.total = res.data.count\n      }\n      this.loading = false\n    }\n  },\n  created() {\n    this.getadminlist()\n  }\n}\n</script>\n<style scoped>\n.top {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: calc(100% - 35px);\n  padding: 12px 16px;\n  background-color: #fff;\n}\n.useruser {\n  position: relative;\n  width: 100%;\n}\n.main {\n  margin-top: 40px;\n  padding: 20px;\n  background-color: #fff;\n}\n</style>\n"]}]}