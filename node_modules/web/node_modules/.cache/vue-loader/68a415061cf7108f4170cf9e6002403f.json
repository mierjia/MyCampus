{"remainingRequest":"D:\\Desktop\\InterConnect\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\InterConnect\\web\\src\\views\\user\\activity\\createactivity.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Desktop\\InterConnect\\web\\src\\views\\user\\activity\\createactivity.vue","mtime":1641975356000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Desktop\\InterConnect\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFZ1ZUVkaXRvciB9IGZyb20gInZ1ZTItZWRpdG9yIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGFibGU6IFtdLAogICAgICBhbm5vdW5jZW1lbnRsaXN0OiBbXSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICB0YWJsZURhdGE6IFtdLCAvL+aKpeWQjeWIl+ihqAogICAgICBkaWFsb2dJbWFnZVVybDogW10sCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBhbm5vdW5jZW1lbnQ6IHsKICAgICAgICBjb250ZW50X2lkOiAiIiwKICAgICAgICB0eXBlOiAiYWN0aXZpdHkiLAogICAgICAgIGFubm91bmNlbWVudF9jb250ZW50OiAiIiwKICAgICAgICBhbm5vdW5jZW1lbnRfbmFtZTogIiIKICAgICAgfSwKICAgICAgZm9ybTogewogICAgICAgIGFjdGl2aXR5X3RpdGxlOiAiIiwKICAgICAgICBhY3Rpdml0eV9pbXBvc2U6IGZhbHNlLAogICAgICAgIGFjdGl2aXR5X251bTogMCwKICAgICAgICBhY3Rpdml0eV90eXBlOiAiIiwKICAgICAgICBhY3Rpdml0eV9sYWJsZTogIiIsCiAgICAgICAgYWN0aXZpdHlfY29udGVudDogIiIsCiAgICAgICAgYWN0aXZpdHlfaW1nOiAiIiwKICAgICAgICBhY3Rpdml0eV9zdGF0ZXRpbWU6ICIiLAogICAgICAgIGFjdGl2aXR5X2VuZHRpbWU6ICIiLAogICAgICAgIGFjdGl2aXR5X2xvY2FsZTogIiIKICAgICAgfQogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIFZ1ZUVkaXRvcgogIH0sCiAgcHJvcHM6IHsKICAgIGlkOiB7fQogIH0sCiAgbWV0aG9kczogewogICAgLyoqCiAgICAgKiBucG0gaW5zdGFsbCB2dWUyLWVkaXRvcgogICAgICoKICAgICAqIOWvjOaWh+acrOe8lui+keWZqOWbvueJh+S4iuS8oAogICAgICovCiAgICBhc3luYyBoYW5kbGVJbWFnZUFkZGVkKGZpbGUsIEVkaXRvciwgY3Vyc29yTG9jYXRpb24sIHJlc2V0VXBsb2FkZXIpIHsKICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlIiwgZmlsZSk7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGF4aW9zLnBvc3QoIi91cGxvZCIsIGZvcm1EYXRhKTsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgRWRpdG9yLmluc2VydEVtYmVkKGN1cnNvckxvY2F0aW9uLCAiaW1hZ2UiLCByZXMuZGF0YS51cmwpOwogICAgICByZXNldFVwbG9hZGVyKCk7CiAgICB9LAogICAgLy/lj5HluIPkuI7nvJbovpEKICAgIGFzeW5jIG9uU3VibWl0KCkgewogICAgICBsZXQgcmVzOwogICAgICBpZiAodGhpcy5pZCkgewogICAgICAgIHRoaXMuZm9ybS5pZCA9IHRoaXMuaWQ7CiAgICAgICAgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgKICAgICAgICAgICIvd2ViYWRtaW4vdXBkYXRlYWN0aXZpdHkiLAogICAgICAgICAgdGhpcy5xcy5zdHJpbmdpZnkodGhpcy5mb3JtKQogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgKICAgICAgICAgICIvd2ViYWRtaW4vY3JlYXRlYWN0aXZpdHkiLAogICAgICAgICAgdGhpcy5xcy5zdHJpbmdpZnkodGhpcy5mb3JtKQogICAgICAgICk7CiAgICAgIH0KICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YS5kYXRhOwogICAgICBpZiAocmVzLmRhdGEuc3RhdGUudHlwZSA9PT0gIlNVQ0NFU1MiKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLmiJDlip8iKTsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2FkbWluL2NyZWF0ZWFjdGl2aXR5bGlzdCIpOwogICAgICB9CiAgICB9LAogICAgLy/lj5HluIPmtLvliqjlhazlkYoKICAgIGFzeW5jIHNldGFubm91bmNlbWVudCgpIHsKICAgICAgdGhpcy5hbm5vdW5jZW1lbnQuY29udGVudG5hbWUgPSB0aGlzLmZvcm0uYWN0aXZpdHlfdGl0bGU7CiAgICAgIHRoaXMuYW5ub3VuY2VtZW50LmNvbnRlbnRfaWQgPSB0aGlzLmlkOwogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgKICAgICAgICAiL2FkbWluL3NldGFubm91bmNlbWVudCIsCiAgICAgICAgdGhpcy5xcy5zdHJpbmdpZnkodGhpcy5hbm5vdW5jZW1lbnQpCiAgICAgICk7CiAgICAgIGlmIChyZXMuZGF0YS5zdGF0ZS50eXBlID09PSAiU1VDQ0VTUyIpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWFrOWRiuWPkeW4g+aIkOWKn+aIkOWKnyIpOwogICAgICAgIHRoaXMuZ2V0YW5ub3VuY2VtZW50bGlzdCgpOwogICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIC8v6I635Y+W5YWs5ZGK5YiX6KGoCiAgICBhc3luYyBnZXRhbm5vdW5jZW1lbnRsaXN0KCkgewogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgKICAgICAgICAiL2FkbWluL2Fubm91bmNlbWVudGxpc3QiLAogICAgICAgIHRoaXMucXMuc3RyaW5naWZ5KHsgY29udGVudF9pZDogdGhpcy5pZCB9KQogICAgICApOwoKICAgICAgaWYgKHJlcy5kYXRhLnN0YXRlLnR5cGUgPT09ICJTVUNDRVNTIikgewogICAgICAgIHRoaXMuYW5ub3VuY2VtZW50bGlzdCA9IHJlcy5kYXRhLmRhdGE7CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgZ2V0YWN0aXZpdHlkZXRhaWxzKCkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRheGlvcy5wb3N0KAogICAgICAgICIvd2ViYWRtaW4vZ2V0YWN0aXZpdHlkZXRhaWxzIiwKICAgICAgICB0aGlzLnFzLnN0cmluZ2lmeSh7IGlkOiB0aGlzLmlkIH0pCiAgICAgICk7CiAgICAgIHRoaXMuZm9ybSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgIHRoaXMuZm9ybS5hY3Rpdml0eV9pbXBvc2UgPSByZXMuZGF0YS5kYXRhLmFjdGl2aXR5X2ltcG9zZSA9PT0gInRydWUiOwogICAgfSwKICAgIGFzeW5jIGdldGpvaW5zbGlzdCgpIHsKICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgKICAgICAgICAiL3dlYmFkbWluL2dldHdlYmpvaW5zbGlzdCIsCiAgICAgICAgdGhpcy5xcy5zdHJpbmdpZnkoeyBpZDogdGhpcy5pZCB9KQogICAgICApOwogICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICB9LAogICAgLy/liIbnsbvliJfooagKICAgIGFzeW5jIGxhYmxlbGlzdCgpIHsKICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuJGF4aW9zLnBvc3QoCiAgICAgICAgIi9hZG1pbi9sYWJsZWxpc3QiLAogICAgICAgIHRoaXMucXMuc3RyaW5naWZ5KHsgbGFibGVfbmFtZTogIua0u+WKqOWIhuexuyIgfSkKICAgICAgKTsKICAgICAgaWYgKHJlcy5kYXRhLnN0YXRlLnR5cGUgPT09ICJTVUNDRVNTIikgewogICAgICAgIC8vIHRoaXMubGFibGUgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgdGhpcy5sYWJsZSA9IEpTT04ucGFyc2UocmVzLmRhdGEuZGF0YVswXS5sYWJsZSk7CiAgICAgICAgY29uc29sZS5sb2coIuWIhuexu+WIl+ihqCIpOwogICAgICAgIGNvbnNvbGUubG9nKHRoaXMubGFibGUpOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5pZCAmJiB0aGlzLmdldGFjdGl2aXR5ZGV0YWlscygpOwogICAgdGhpcy5pZCAmJiB0aGlzLmdldGpvaW5zbGlzdCgpOwogICAgdGhpcy5pZCAmJiB0aGlzLmdldGFubm91bmNlbWVudGxpc3QoKTsKICAgIHRoaXMubGFibGVsaXN0KCk7CiAgfQp9Owo="},{"version":3,"sources":["createactivity.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"createactivity.vue","sourceRoot":"src/views/user/activity","sourcesContent":["<template>\n  <div class=\"createactivity\">\n    <h2>{{id?'编辑':'创建' }}活动</h2>\n\n    <el-tabs type=\"border-card\">\n      <el-tab-pane label=\"活动编辑\">\n        <el-form ref=\"form\" :model=\"form\" label-width=\"80px\" size=\"medium \">\n          <el-form-item label=\"活动名称\">\n            <el-input v-model=\"form.activity_title\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"开始时间\">\n            <el-date-picker\n              v-model=\"form.activity_statetime\"\n              type=\"datetime\"\n              value-format=\"timestamp\"\n              placeholder=\"选择日期时间\"\n            ></el-date-picker>\n          </el-form-item>\n\n          <el-form-item label=\"结束时间\">\n            <el-date-picker\n              value-format=\"timestamp\"\n              v-model=\"form.activity_endtime\"\n              type=\"datetime\"\n              placeholder=\"选择日期时间\"\n            ></el-date-picker>\n          </el-form-item>\n\n          <el-form-item label=\"地点\">\n            <el-input v-model=\"form.activity_locale\"></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"人数限制\">\n            <el-switch v-model=\"form.activity_impose\"></el-switch>\n          </el-form-item>\n\n          <el-form-item label=\"活动人数\">\n            <el-input\n              :rules=\"[\n      { required: true, message: '人数不能为空'},\n      { type: 'number', message: '人数必须为数字值'}\n    ]\"\n              v-model=\"form.activity_num\"\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"活动分类\">\n            <el-radio-group v-model=\"form.activity_lable\">\n              <el-radio\n                v-for=\"(item,id) in lable\"\n                :key=\"id\"\n                :class=\"'page_span_'+id \"\n                :label=\"item\"\n              >{{item}}</el-radio>\n            </el-radio-group>\n          </el-form-item>\n\n          <el-form-item label=\"活动形式\">\n            <el-radio-group v-model=\"form.activity_type\">\n              <el-radio label=\"线上\"></el-radio>\n              <el-radio label=\"线下\"></el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-form-item label=\"内容介绍\">\n            <vue-editor\n              useCustomImageHandler\n              @image-added=\"handleImageAdded\"\n              v-model=\"form.activity_content\"\n            ></vue-editor>\n          </el-form-item>\n\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"onSubmit\">确定</el-button>\n            <el-button>取消</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n      <el-tab-pane v-if=\"id\" label=\"公告管理\">\n        <el-button type=\"text\" icon=\"el-icon-plus\" @click=\"dialogFormVisible = true\">添加新的活动公告</el-button>\n        <el-dialog title=\"发布公告 \" :visible.sync=\"dialogFormVisible\" width=\"30%\">\n          <el-form :model=\"announcement\" size=\"medium \">\n            <el-form-item label=\"公告名称\">\n              <el-input autocomplete=\"off\" v-model=\"announcement.announcement_name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"公告类容\">\n              <el-input\n                type=\"textarea\"\n                autocomplete=\"off\"\n                v-model=\"announcement.announcement_content\"\n              ></el-input>\n            </el-form-item>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"setannouncement\">确 定</el-button>\n          </div>\n        </el-dialog>\n        <div class=\"block\">\n          <el-timeline>\n            <el-timeline-item\n              v-for=\"(item,id) in announcementlist\"\n              :key=\"id\"\n              :timestamp=\"item.announcement_createtime | dataFormat\"\n              placement=\"top\"\n            >\n              <el-card>\n                <h4>{{item.announcement_name}}</h4>\n                <p>{{item.announcement_content}}</p>\n              </el-card>\n            </el-timeline-item>\n          </el-timeline>\n        </div>\n      </el-tab-pane>\n      <el-tab-pane v-else label=\"公告管理\">请先添加活动，活动添加成功后才可以添加活动公告</el-tab-pane>\n      <el-tab-pane label=\"活动人员管理\">\n        <el-table :data=\"tableData\" border style=\"width: 100%\">\n          <el-table-column fixed prop=\"createtime\" label=\"报名日期\">\n            <template slot-scope=\"scope\">{{ scope.row.joins_createtime | dataFormat }}</template>\n          </el-table-column>\n          <el-table-column prop=\"username\" label=\"账号\"></el-table-column>\n          <el-table-column prop=\"nickname\" label=\"昵称\"></el-table-column>\n          <el-table-column prop=\"qq\" label=\"qq\"></el-table-column>\n          <el-table-column prop=\"phone\" label=\"手机号\"></el-table-column>\n        </el-table>\n      </el-tab-pane>\n    </el-tabs>\n  </div>\n</template>\n<script>\nimport { VueEditor } from \"vue2-editor\";\n\nexport default {\n  data() {\n    return {\n      lable: [],\n      announcementlist: [],\n      dialogFormVisible: false,\n      tableData: [], //报名列表\n      dialogImageUrl: [],\n      dialogVisible: false,\n      announcement: {\n        content_id: \"\",\n        type: \"activity\",\n        announcement_content: \"\",\n        announcement_name: \"\"\n      },\n      form: {\n        activity_title: \"\",\n        activity_impose: false,\n        activity_num: 0,\n        activity_type: \"\",\n        activity_lable: \"\",\n        activity_content: \"\",\n        activity_img: \"\",\n        activity_statetime: \"\",\n        activity_endtime: \"\",\n        activity_locale: \"\"\n      }\n    };\n  },\n  components: {\n    VueEditor\n  },\n  props: {\n    id: {}\n  },\n  methods: {\n    /**\n     * npm install vue2-editor\n     *\n     * 富文本编辑器图片上传\n     */\n    async handleImageAdded(file, Editor, cursorLocation, resetUploader) {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await this.$axios.post(\"/uplod\", formData);\n      console.log(res);\n      Editor.insertEmbed(cursorLocation, \"image\", res.data.url);\n      resetUploader();\n    },\n    //发布与编辑\n    async onSubmit() {\n      let res;\n      if (this.id) {\n        this.form.id = this.id;\n        res = await this.$axios.post(\n          \"/webadmin/updateactivity\",\n          this.qs.stringify(this.form)\n        );\n      } else {\n        res = await this.$axios.post(\n          \"/webadmin/createactivity\",\n          this.qs.stringify(this.form)\n        );\n      }\n      let data = res.data.data;\n      if (res.data.state.type === \"SUCCESS\") {\n        this.$message.success(\"成功\");\n        this.$router.push(\"/admin/createactivitylist\");\n      }\n    },\n    //发布活动公告\n    async setannouncement() {\n      this.announcement.contentname = this.form.activity_title;\n      this.announcement.content_id = this.id;\n      let res = await this.$axios.post(\n        \"/admin/setannouncement\",\n        this.qs.stringify(this.announcement)\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        this.$message.success(\"公告发布成功成功\");\n        this.getannouncementlist();\n        this.dialogFormVisible = false;\n      }\n    },\n    //获取公告列表\n    async getannouncementlist() {\n      let res = await this.$axios.post(\n        \"/admin/announcementlist\",\n        this.qs.stringify({ content_id: this.id })\n      );\n\n      if (res.data.state.type === \"SUCCESS\") {\n        this.announcementlist = res.data.data;\n      }\n    },\n\n    async getactivitydetails() {\n      const res = await this.$axios.post(\n        \"/webadmin/getactivitydetails\",\n        this.qs.stringify({ id: this.id })\n      );\n      this.form = res.data.data;\n      this.form.activity_impose = res.data.data.activity_impose === \"true\";\n    },\n    async getjoinslist() {\n      const res = await this.$axios.post(\n        \"/webadmin/getwebjoinslist\",\n        this.qs.stringify({ id: this.id })\n      );\n      this.tableData = res.data.data;\n    },\n    //分类列表\n    async lablelist() {\n      let res = await this.$axios.post(\n        \"/admin/lablelist\",\n        this.qs.stringify({ lable_name: \"活动分类\" })\n      );\n      if (res.data.state.type === \"SUCCESS\") {\n        // this.lable = res.data.data\n        this.lable = JSON.parse(res.data.data[0].lable);\n        console.log(\"分类列表\");\n        console.log(this.lable);\n      }\n    }\n  },\n  created() {\n    this.id && this.getactivitydetails();\n    this.id && this.getjoinslist();\n    this.id && this.getannouncementlist();\n    this.lablelist();\n  }\n};\n</script>\n"]}]}